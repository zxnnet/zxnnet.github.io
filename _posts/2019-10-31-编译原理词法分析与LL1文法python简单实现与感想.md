---
layout: article
title: ç¼–è¯‘åŸç†è¯æ³•åˆ†æä¸LL1æ–‡æ³•pythonç®€å•ç¨‹åºä¸æ„Ÿæƒ³
tags: ç¼–è¯‘ æ„Ÿæ‚Ÿ
mode: immersive
key: o12
aside:
  toc: true
header:
  theme: dark
article_header:
  type: overlay
  theme: dark
  background_color: '#203028'
  background_image:
    gradient: 'linear-gradient(135deg, rgba(34, 139, 87 , .4), rgba(139, 34, 139, .4))'
    src: https://raw.githubusercontent.com/viewv/Pico/master/img/spyroBlack_rainbow-01.png
---

# ç¼–è¯‘åŸç†è¯æ³•åˆ†æä¸LL1æ–‡æ³•pythonç®€å•å®ç°ä¸æ„Ÿæƒ³

ä»åŒ—äº¬äº¤æµå›æ¥ï¼ŒåŸæœ¬ä¼¼ä¹å¾ˆæœ‰å¿—æ°”çš„æˆ‘ï¼šâ€œå–ä¸­åå°Šä¸ºå™¨ï¼Œä¸­å—æµ·ä¸ºé…’ï¼Œé¥®ä¸ä¸œè¥¿ä¹‹åŸåŒºï¼Œå§æ•æˆ¿å±±è€Œçœ â€ï¼Œï¼ˆå°±æ˜¯æå†™å‡ºæ²³åŒ—è½¬ä¸€è½¬ä¹‹åå›æˆ¿å±±æŸç†å·¥å­¦æ ¡ç¡è§‰ï¼‰ã€‚å›æ¥å‘ç°è‡ªå·±å·²ç»å˜æˆæ†¨æ†¨ï¼Œç§‘ç ”ç«èµ›ä¼¼ä¹æ²¡æˆ‘å•¥äº‹ï¼Œäººä¹Ÿä¸å¤§ç†Ÿå‡ ä¸ªï¼Œä¿ç ”ä¹Ÿæ˜¯å¹äº†ï¼Œä¸€ä¸‹å­å˜æˆï¼šâ€œæ³ªçŒç§‹è‰éš¾å†è£ï¼Œè½å¶å‡„æƒ¨æ»¡æå¤´ã€‚å¯’æ„å¿…ç½ªç§‹é£ç››ï¼Œä½•å¹²ä¸æˆ‘èµ¤å­å¿ƒã€‚â€ æ¶ˆæ²‰å®Œäº†ï¼Œæ—¥å­è¿˜å¾—è¿‡ï¼Œç»§ç»­ç”Ÿæ´»å§ï¼Œåšå®¢åœäº†å¥½ä¹…ï¼Œå¾—æ›´æ–°æ›´æ–°ã€‚

## è¯æ³•åˆ†æ

è¯¾ç¨‹ä¸­è€å¸ˆåªè®©å¯¹ä¸€ä¸ªç®€å•çš„Cè¯­è¨€å­é›†åˆï¼Œåœ¨è¿™é‡Œæˆ‘å‚è€ƒäº†ä¸€ç‰‡æ–‡ç« ä¸­çš„çŠ¶æ€æœºæ€æƒ³ï¼Œæ”¹å†™äº†ä¸€ä¸‹ï¼Œæ„Ÿè§‰æ•ˆæœemmmè¿˜è¯´çš„è¿‡å»ï¼Œè¿™é‡Œå…ˆç»™å‡ºä»£ç ï¼Œä¸è¿‡è¿™ä¸ªèœä»£ç å¤§å®¶çœ‹çœ‹æœ‰æ²¡æœ‰å¯å–ä¹‹å¤„å°±å–ä¸€ä¸‹ï¼Œè‚¯å®šbugæ®‹ç¼ºä¸€å †ï¼Œä½†æ˜¯å¯¹æˆ‘æµ‹è¯•çš„ä¾‹å­æ˜¯å¯¹çš„ï¼š

```python
# -*- coding: utf-8 -*-

import string

keyword = ("auto", "break", "case", "char", "const", "continue", "default",
           "do", "double", "else", "enum", "extern", "float", "for",
           "goto", "if", "int", "long", "register", "return", "short",
           "signed", "static", "sizeof", "struct", "switch", "typedef", "union",
           "unsigned", "void", "volatile", "while")  # cè¯­è¨€çš„32ä¸ªå…³é”®å­—

user_dict = {}  # ç”¨æˆ·æ ‡è¯†ç¬¦å­—å…¸
uint_dict = {}  # æ— ç¬¦å·å¸¸æ•°å­—å…¸
idlist = []  # ç”¨æˆ·æ ‡è¯†ç¬¦åˆ—è¡¨
uintlist = []  # æ— ç¬¦å·æ•´æ•°åˆ—è¡¨

'''
SS: èµ·å§‹çŠ¶æ€
FS: æ¥å—çŠ¶æ€
I: æ¥å—å­—ç¬¦
T: è½¬æ¢è¡¨   //å¦‚"8": {"3": 10, "5": 9}è¡¨ç¤ºçŠ¶æ€8è¾“å…¥I[3]å¯ä»¥è½¬æ¢åˆ°çŠ¶æ€10, çŠ¶æ€8è¾“å…¥I[3]å¯ä»¥è½¬æ¢åˆ°çŠ¶æ€9
S: çŠ¶æ€è¡¨    //ä¸‹æ ‡å¯¹åº”çš„çŠ¶æ€çš„å«ä¹‰
'''
state_machine = {
    "SS": 0,
    "T": {
        0: {
            "2": 1,
            "0": 3,
            "4": 5,
            "5": 6,
            "6": 7,
            "7": 8,
            "8": 11,
            "3": 14,
            "1": 15,
            "default": 0,
        },
        1: {
            "0": 1,
            "2": 1,
            "default": 2,
        },
        3: {
            "0": 3,
            "default": 4,
        },
        8: {
            "8": 9,
            "default": 10,
        },
        11: {
            "8": 12,
            "default": 13,
        }
    },
    "I": {
        "0": ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'],
        "1": ['@', '#', '$', "^", "&", "~"],
        "2": ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z',
              'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'],
        "3": ['{', '}', '[', ']', ';', '(', ')', ',', ' ', '.', '\n', '"', "'"],
        "4": ['+'],
        "5": ['-'],
        "6": ['*'],
        "7": ['<'],
        "8": ['='],
    },
    "FS": (2, 4, 5, 6, 7, 9, 10, 12, 13, 14, 15),
    "S": ["start", 'id_s', 'id', 'uint_s', 'uint', 'op+', 'op-', 'op*', 'op<_s', 'op<=', 'op<', 'op=_s', 'op_==', 'op=', 'div', 'error']
}


def delComment(content):
    # å»é™¤ä»£ç ä¸­çš„æ³¨é‡Š
    state = 0
    index = -1

    for c in content:
        index = index + 1

        if state == 0:
            if c == '/':
                state = 1
                startIndex = index

        elif state == 1:
            if c == '*':
                state = 2
            else:
                state = 0

        elif state == 2:
            if c == '*':
                state = 3
            else:
                pass

        elif state == 3:
            if c == '/':
                endIndex = index + 1
                comment = content[startIndex:endIndex]
                content = content.replace(comment, '')  # å°†æ³¨é‡Šæ›¿æ¢ä¸ºç©ºï¼Œå¹¶ä¸”å°†ä¸‹æ ‡ç§»åŠ¨
                index = startIndex - 1
                state = 0

            elif c == '*':
                pass
            else:
                state = 2
    return content


def getConnent(filename):
    content = ''
    f = open(filename, 'r')
    file = f.readlines()
    for line in file:
        if line != '\n':
            content = "%s%s" % (content, line.lstrip())
        # else:
        #     content = "%s%s" % (content, line)
    f.close()
    return content


def analysis(content):
    o = open("output.txt", 'w+')
    curr_status = 0
    word = ""
    l = len(content)
    x = 0
    while x < l:
        c = content[x]
        flag = 'default'
        for i in state_machine["I"]:
            alpha = state_machine["I"][i]
            if c in alpha:
                flag = i
                break
        if flag in state_machine['T'][curr_status]:
            curr_status = state_machine['T'][curr_status][flag]
        else:
            curr_status = state_machine['T'][curr_status]['default']
        if curr_status in state_machine["FS"]:
            state = state_machine["S"][curr_status]
            if curr_status == 2:
                if word in keyword:
                    res = "<res," + word + ">"
                elif word not in user_dict:
                    res = "<"+state+","+word+">"
                    idlist.append(word)
                    user_dict[word] = 0
                else:
                    res = "<"+state+","+word+">"
            elif curr_status == 4:
                if word not in uint_dict:
                    res = "<"+state+","+word+">"
                    uintlist.append(word)
                    uint_dict[word] = 0
                else:
                    res = "<" + state + "," + word + ">"
            elif curr_status in (5, 6, 7, 14, 15):  # é’ˆå¯¹è¿™å‡ ä¸ªç«‹å³æ¥å—çš„åšåˆ¤æ–­
                if c != '\n' and c != " ":
                    res = "<" + state + "," + c + ">"
                else:
                    res = None
                x += 1
            else:
                res = "<" + state + "," + word + ">"
                # x -= 1
            if res is not None:
                o.writelines(res + '\n')
                print(res)
            curr_status = 0
            word = ""
            c = ""
            x -= 1
        word += c
        x += 1
    o.close()


if __name__ == "__main__":
    content = getConnent('./test.c')
    content = delComment(content)
    i = open('idlist.txt', 'w+')
    u = open('uintlist.txt', 'w+')
    print('=======================')
    print("output")
    print("Enter means \\n, Space means space")
    analysis(content)
    print('=======================')
    print("idlist")
    print(idlist)
    print('=======================')
    print("uintlist")
    print(uintlist)
    for x in idlist:
        i.writelines(x+'\t' + '\n')
    for x in uintlist:
        u.writelines(x+'\t' + '\n')
    i.close()
    u.close()
```

åŸºæœ¬æ€æƒ³å°±æ˜¯è¯»ä¸€ä¸ªè½¬åŒ–ä¸€ä¸ªçŠ¶æ€ï¼Œåˆ°æ¥å—çŠ¶æ€å°±åšä¸€ä¸‹å¤„ç†ï¼Œè¿™ä¹ˆé•¿çš„åŸå› æ˜¯é‚£ä¸ªçŠ¶æ€æœºå†™çš„æœ‰ç‚¹é«˜ï¼Œå†™æ‰äº†å°±å¥½çœ‹äº†åº”è¯¥ï¼Œè¿™ä¸ªæ˜¯è€å¸ˆé‚£ä¸ªpptä¸Šä¸€ä¸ªåªæœ‰15ä¸ªçŠ¶æ€çš„éå¸¸ç®€å•çš„çŠ¶æ€æœºï¼Œåº”ä»˜æ£€æŸ¥ï¼Œæ•ˆç‡ä¹‹ç±»çš„æ€•æ˜¯å¾ˆä½ï¼Œæˆ‘å†™å®Œä¹‹åç”¨ä¸€ä¸ªâ€œè®¾è®¡â€ï¼ˆç»“æœç¬¦åˆé¢„æœŸï¼‰çš„cæ–‡ä»¶è¿›å»ï¼Œè¿˜æ˜¯å¯¹çš„ï¼Œå¯¹äº†ï¼ŒæŠŠpptçš„å›¾æ”¾ä¸Šå»ï¼Œä¸‡ä¸€ç”¨çš„æ˜¯ä¸€ä¸ªpptğŸ˜‚

![è¯æ³•åˆ†æçŠ¶æ€Cè¯­è¨€å­é›†](https://raw.githubusercontent.com/viewv/Pico/master/img/Screen%20Shot%202019-10-31%20at%208.47.56%20PM.png)

ä½†æ˜¯ç¨‹åºçš„æ€æƒ³åº”è¯¥æ˜¯å¯¹çš„ï¼Œå‰¥ç¦»å‡ºæ¥è¯æ³•åˆ†æçš„çŠ¶æ€è½¬ç§»éƒ¨åˆ†ï¼Œè¿™æ ·å¯ä»¥è®©æ§åˆ¶ç¨‹åºè·å¾—ä¸€å®šçš„ç‹¬ç«‹æ€§ï¼Œæ”¹äº†è¯­è¨€ä¹Ÿèƒ½å¾ˆå¿«çš„ä¿®æ”¹ã€‚

## LL(1) è¯­æ³•åˆ†æå™¨

### First é›†åˆ

æœ‰æœºä¼šä¼šåœ¨è¿™é‡Œç»™å‡ºå…·ä½“çš„è§£é‡Šï¼Œè¿™ä¸ªä¸œè¥¿è¿˜æ˜¯ç²¾å¦™ï¼Œè¿™ç¯‡æ–‡ç« åªæ˜¯ç»™å‡ºç¨‹åºï¼Œå¦‚æœè¦è¿›è¡ŒLL(1)é‚£è‚¯å®šå°±è¦æœ‰LL(1)åˆ†æè¡¨ï¼Œæƒ³è¦LL(1)åˆ†æè¡¨å°±éœ€è¦Firsté›†å’ŒFollowé›†ï¼Œè€ŒFirståˆæ˜¯æ±‚Firsté›†çš„å‰æï¼Œæ‰€ä»¥å…ˆç»™å‡ºFirsté›†çš„æ±‚è§£ç¨‹åºã€‚

é¦–å…ˆè¿˜æ˜¯è¦å®šä¹‰æ–‡æ³•ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªï¼ˆç®€å•ï¼‰æ–‡æ³•ï¼š
$$
\begin{align*}  
G[E]:
  & E \rightarrow TA \\
	& A \rightarrow +TA | \varepsilon \\
	& T \rightarrow FB \\
	& B \rightarrow *FB | \varepsilon \\
	& F \rightarrow (E) | i
\end{align*} 
$$
æˆ‘ä¸­äº†å­—å…¸çš„æ¯’ï¼Œå°±è¿™ä¹ˆå®šä¹‰è¿™ä¸ªæ–‡æ³•ï¼š

```python
'''
è¯­æ³•å®šä¹‰
"SS"ä¸ºèµ·å§‹ç¬¦
"T"ä¸ºè½¬æ¢æ¡ä»¶ï¼Œå¦‚
"A": {
    ["+", "T", "A"],
    ["e"]
}
ä»£è¡¨ A->+TA|e
(eä»£è¡¨ç©º)
"VT"ä¸ºç»ˆæ­¢ç¬¦
"VN"ä¸ºéç»ˆæ­¢ç¬¦
'''
grammer = {
    "SS": 'E',
    "T": {
        "E": {
            0: ["T", "A"]
        },
        "A": {
            0: ["+", "T", "A"],
            1: ["âˆ‘"]
        },
        "T": {
            0: ["F", "B"]
        },
        "B": {
            0: ["*", "F", "B"],
            1: ["âˆ‘"]
        },
        "F": {
            0: ["(", "E", ")"],
            1: ["i"]
        }
    },
    "VN": ["E", "A", "T", "B", "F"],
    "VT": ["i", "+", "*", "(", ")", "#"],
    "NN": ["âˆ‘"]
}
```

è¿™æ ·å®šä¹‰å…¶å®è¿˜æ˜¯æ¸…æ™°çš„ï¼Œè¿™æ¬¡åˆ†ç¦»çš„æ›´å¹²å‡€ï¼Œé‚£ä¹ˆè®¡ç®—Firsté›†åˆçš„å‡½æ•°å‘¢ï¼Ÿ

```python
def first(grammer, state):  # è®¡ç®—ä¸€ä¸ª state çš„ first é›†åˆ
    ans = set()
    if state in grammer["VT"]:
        return {state}
    next_dict = grammer["T"][state]
    for key in next_dict:
        next_list = next_dict[key]
        for x in next_list:
            if x in grammer["VT"]:
                ans.add(x)
                break
            elif x in grammer["NN"]:
                ans.add(x)
                break
            else:
                res = first(grammer, x)
                if grammer["NN"][0] not in res:
                    # è¿™ä»£è¡¨æ²¡æœ‰åŠæ³•è‡ªåŠ¨åŒ¹é…ï¼Œ
                    # å¦‚X->Y1Y2..å¦‚æœFirst(Y1)æ²¡æœ‰ NN
                    # é‚£ä¹ˆæ²¡æœ‰åŠæ³•åŒ¹é… Y2 çš„Firsté›†,break
                    ans = ans.union(res)
                    break
                else:
                    ans = ans.union(res.remove(grammer["NN"][0]))
                    # æ³¨æ„è¿™é‡Œå°±æ²¡æœ‰breakäº†
    return ans
```

æ„å¤–çš„ç®€å•ï¼Œpythonè¿˜æ˜¯ä¸é”™ï¼Œä½¿ç”¨è¿™ä¸ªå‡½æ•°å°±å¯ä»¥è®¡ç®—å‡ºæ¥Firsté›†ï¼ŒsetçœŸå¥½ç”¨

### Followé›†

è®¡ç®—Flollowé›†åˆæˆ‘ä¸ªäººæ„Ÿè§‰éš¾å¤šäº†ï¼Œå¯èƒ½æˆ‘é€‰ç”¨çš„æ–¹æ³•ä¸å¤ªå¯¹ï¼Œä½†æ˜¯ä¹Ÿæ˜¯å»ºç«‹åœ¨æœ‰Firstè¿™ä¸ªå‡½æ•°çš„å‰æä¸‹ï¼Œè¿™é‡Œä¸æ¶‰åŠè®¡ç®—çš„ç®—æ³•ï¼Œè¿˜æ˜¯åªç»™å‡ºç¨‹åºï¼š

```python
def follow(grammer, fllow_set):
    nums = [len(fllow_set[x]) for x in fllow_set]
    for key in grammer["T"]:
        nex_dict = grammer["T"][key]
        for seq in nex_dict:
            nex_list = nex_dict[seq]
            length = len(nex_list)
            for x in range(length - 1):
                char = nex_list[x]
                if char in grammer["VN"]:
                    loc = x + 1
                    res = first(grammer, nex_list[loc])
                    if grammer["NN"][0] in res:
                        fllow_set[char] = fllow_set[char].union(fllow_set[key])
                        res.remove(grammer["NN"][0])
                    fllow_set[char] = fllow_set[char].union(res)
            x = length - 1
            if nex_list[x] in grammer["VN"]:
                fllow_set[nex_list[x]] = fllow_set[nex_list[x]].union(
                    fllow_set[key])
    n_nums = [len(fllow_set[x]) for x in fllow_set]
    if n_nums == nums:
        return fllow_set
    else:
        return follow(grammer, fllow_set)
```

æˆ‘æ˜¯ç”¨çš„ç®—æ³•æ˜¯éœ€è¦å¤šæ¬¡å¾ªç¯é€’å½’ï¼Œç›´åˆ°Followé›†åˆä¸å˜å°±è¾“å‡ºï¼Œè·ŸFirsté›†è®¡ç®—ä¸ä¸€æ ·ï¼Œè·‘å®Œäº†ï¼Œæ‰€æœ‰çš„éç»ˆæ­¢ç¬¦çš„Followé›†åˆå°±å‡ºæ¥äº†ï¼ŒåŸç†ç­‰ä¸‹ä¸€ç¯‡æ–‡ç« å†™ã€‚

### LL(1)è¡¨è®¡ç®—

æœ‰äº†å‰é¢ä¸¤ä¸ªçš„é“ºå«ï¼Œè¿™ä¸ªå°±å¥½è®¡ç®—äº†ï¼Œä¸è¿‡è¿˜æ˜¯éœ€è¦äº†è§£å…·ä½“æ€ä¹ˆè®¡ç®—çš„ï¼Œè¿™é‡Œç»™å‡ºç¨‹åºï¼š

```python
def ll1(grammer, first_set, fllow_set, ll1_table):
    vt_list = grammer["VT"]
    tran = grammer["T"]
    for vn in tran:
        nex_dict = tran[vn]
        res = first_set[vn]
        if grammer["NN"][0] in res:
            fow = fllow_set[vn]
            for a in fow:
                if a in grammer["VT"]:
                    ll1_table[vn][a] = vn + "->" + "âˆ‘"
            res.remove(grammer["NN"][0])
        for a in res:
            express = ""
            for key in nex_dict:
                nex_list = nex_dict[key]
                for x in nex_list:
                    if x in grammer["VN"]:
                        res = first_set[x]
                        if a in res:
                            express = "".join(nex_list)
                            break
                    else:
                        if x == a:
                            express = "".join(nex_list)
                            break
            ll1_table[vn][a] = vn + "->"+express
    return ll1_table
```

é€šè¿‡è¿™ä¸ªç¨‹åºæœ€åç»¼åˆå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªå®Œæ•´çš„è®¡ç®—LL(1)åˆ†æè¡¨çš„ç¨‹åºï¼Œè®¡ç®—åº”è¯¥æ˜¯å¯¹çš„ï¼Œä¸‹é¢ç»™å‡ºå®Œæ•´çš„ç¨‹åºã€‚

### å®Œæ•´ç¨‹åº

```python
# -*- coding: utf-8 -*-

import string

'''
è¯­æ³•å®šä¹‰
"SS"ä¸ºèµ·å§‹ç¬¦
"T"ä¸ºè½¬æ¢æ¡ä»¶ï¼Œå¦‚
"A": {
    ["+", "T", "A"],
    ["e"]
}
ä»£è¡¨ A->+TA|e
(eä»£è¡¨ç©º)
"VT"ä¸ºç»ˆæ­¢ç¬¦
"VN"ä¸ºéç»ˆæ­¢ç¬¦
'''
grammer = {
    "SS": 'E',
    "T": {
        "E": {
            0: ["T", "A"]
        },
        "A": {
            0: ["+", "T", "A"],
            1: ["âˆ‘"]
        },
        "T": {
            0: ["F", "B"]
        },
        "B": {
            0: ["*", "F", "B"],
            1: ["âˆ‘"]
        },
        "F": {
            0: ["(", "E", ")"],
            1: ["i"]
        }
    },
    "VN": ["E", "A", "T", "B", "F"],
    "VT": ["i", "+", "*", "(", ")", "#"],
    "NN": ["âˆ‘"]
}

# ä¹¦ä¸­ä¹ é¢˜2çš„æ–‡æ³•ï¼Œåœ¨è¿™é‡Œæµ‹è¯•ç¨‹åºçš„é€šç”¨æ€§
grammer_t = {
    "SS": 'E',
    "T": {
        "E": {
            0: ["T", "A"]
        },
        "A": {
            0: ["+", "E"],
            1: ["âˆ‘"]
        },
        "T": {
            0: ["F", "B"]
        },
        "B": {
            0: ["T"],
            1: ["âˆ‘"]
        },
        "F": {
            0: ["P", "C"],
        },
        "C": {
            0: ["*", "C"],
            1: ["âˆ‘"]
        },
        "P": {
            0: ["(", "E", ")"],
            1: ["a"],
            2: ["b"],
            3: ["^"]

        }
    },
    "VN": ["E", "A", "T", "B", "F", "C", "P"],
    "VT": ["+", "*", "(", ")", "^", "a", "b", "#"],
    "NN": ["âˆ‘"]
}

fllow_set = {}
first_set = {}
ll1_table = {}


def first(grammer, state):  # è®¡ç®—ä¸€ä¸ª state çš„ first é›†åˆ
    ans = set()
    if state in grammer["VT"]:
        return {state}
    next_dict = grammer["T"][state]
    for key in next_dict:
        next_list = next_dict[key]
        for x in next_list:
            if x in grammer["VT"]:
                ans.add(x)
                break
            elif x in grammer["NN"]:
                ans.add(x)
                break
            else:
                res = first(grammer, x)
                if grammer["NN"][0] not in res:
                    # è¿™ä»£è¡¨æ²¡æœ‰åŠæ³•è‡ªåŠ¨åŒ¹é…ï¼Œ
                    # å¦‚X->Y1Y2..å¦‚æœFirst(Y1)æ²¡æœ‰ NN
                    # é‚£ä¹ˆæ²¡æœ‰åŠæ³•åŒ¹é… Y2 çš„Firsté›†,break
                    ans = ans.union(res)
                    break
                else:
                    ans = ans.union(res.remove(grammer["NN"][0]))
                    # æ³¨æ„è¿™é‡Œå°±æ²¡æœ‰breakäº†
    return ans


def follow(grammer, fllow_set):
    nums = [len(fllow_set[x]) for x in fllow_set]
    for key in grammer["T"]:
        nex_dict = grammer["T"][key]
        for seq in nex_dict:
            nex_list = nex_dict[seq]
            length = len(nex_list)
            for x in range(length - 1):
                char = nex_list[x]
                if char in grammer["VN"]:
                    loc = x + 1
                    res = first(grammer, nex_list[loc])
                    if grammer["NN"][0] in res:
                        fllow_set[char] = fllow_set[char].union(fllow_set[key])
                        res.remove(grammer["NN"][0])
                    fllow_set[char] = fllow_set[char].union(res)
            x = length - 1
            if nex_list[x] in grammer["VN"]:
                fllow_set[nex_list[x]] = fllow_set[nex_list[x]].union(
                    fllow_set[key])
    n_nums = [len(fllow_set[x]) for x in fllow_set]
    if n_nums == nums:
        return fllow_set
    else:
        return follow(grammer, fllow_set)


def ll1(grammer, first_set, fllow_set, ll1_table):
    vt_list = grammer["VT"]
    tran = grammer["T"]
    for vn in tran:
        nex_dict = tran[vn]
        res = first_set[vn]
        if grammer["NN"][0] in res:
            fow = fllow_set[vn]
            for a in fow:
                if a in grammer["VT"]:
                    ll1_table[vn][a] = vn + "->" + "âˆ‘"
            res.remove(grammer["NN"][0])
        for a in res:
            express = ""
            for key in nex_dict:
                nex_list = nex_dict[key]
                for x in nex_list:
                    if x in grammer["VN"]:
                        res = first_set[x]
                        if a in res:
                            express = "".join(nex_list)
                            break
                    else:
                        if x == a:
                            express = "".join(nex_list)
                            break
            ll1_table[vn][a] = vn + "->"+express

    return ll1_table


if __name__ == "__main__":
    grammer = grammer_t # è®°å¾—ä¿®æ”¹å‘¦ï¼è‡ªå·±ç”¨çš„æ—¶å€™ï½
    for x in grammer["VN"]:
        fllow_set[x] = set()
    fllow_set[grammer["SS"]].add("#")
    fllow_set = follow(grammer, fllow_set)
    for x in grammer["VN"]:
        first_set[x] = first(grammer, x)
        ll1_table[x] = {}
        for y in grammer["VT"]:
            ll1_table[x][y] = "error"
    ll1_table = ll1(grammer, first_set, fllow_set, ll1_table)
    print('=======================')
    print("first set")
    print('=======================')
    for key in grammer["VN"]:
        print(key, first(grammer, key))
    print('=======================')
    print("fllow set")
    print('=======================')
    for key in fllow_set:
        print(key, fllow_set[key])
    print('=======================')
    print("ll1 table")
    print("VN\VT", end="\t")
    for x in grammer["VT"]:
        print(x, end="\t")
    print()
    for vn in ll1_table:
        nex_dict = ll1_table[vn]
        print(vn, end="\t")
        for key in nex_dict:
            print(nex_dict[key], end="\t")
        print()
    print('=======================')
```

åœ¨è¿™é‡Œgrammeræ˜¯é‚£ä¸ªç®€å•çš„æ–‡æ³•ï¼Œè€Œgrammer_tå¦‚ç¨‹åºä¸­å†™çš„æ˜¯ä¸€ä¸ªä¹ é¢˜çš„æ–‡æ³•ï¼Œè¯è¯´æˆ‘è‡ªå·±å†™å‡ºæ¥è¿™ä¸ªç¨‹åºèƒ½æ±‚å¯¹è¿™äº›ç©æ„ï¼Œæˆ‘å½“æ—¶æ‰‹ç®—å°±ä¸ä¼šäº†ï¼Œç»“æœé è‡ªå·±çš„ç¨‹åºæ¥è·‘å‡ºæ¥ç»“æœÂ ğŸ˜‚

## ç»“å°¾

è¿™æ ·å°±å®Œæˆäº†è¿™ä¹ˆä¸€ä¸ªä½œä¸šï¼Œå†™çš„æœ¬èœé¸¡è¿˜æ˜¯åºŸäº†ç‚¹æ—¶é—´ï¼Œè‡³äºè¯´å¼€å¤´å‘çš„ç‰¢éªšï¼Œè¯¶ï¼Œåªèƒ½ç»§ç»­ç”Ÿå­˜ä¸‹å»äº†ï¼Œä¼¼ä¹è¿˜æƒ³ç»§ç»­ä¸Šå­¦ï¼Œæ‰€ä»¥åº”è¯¥ä¼šå»è€ƒç ”ï¼ŒçœŸæ˜¯é¸¡å„¿éš¾ï¼Œæ„¿ä¸Šå¸åº‡ä½‘æˆ‘ã€‚